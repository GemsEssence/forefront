<li>
  <%= link_to ticket_path(ticket), class: "block hover:bg-gray-50" do %>
    <div class="px-4 py-4 sm:px-6">
      <div class="flex items-center justify-between">
        <div class="flex-1">
          <div class="flex items-center">
            <p class="text-sm font-medium text-indigo-600 truncate"><%= ticket.title %></p>
            <span class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-<%= ticket.priority == 'critical' ? 'red' : ticket.priority == 'high' ? 'orange' : ticket.priority == 'medium' ? 'yellow' : 'gray' %>-100 text-<%= ticket.priority == 'critical' ? 'red' : ticket.priority == 'high' ? 'orange' : ticket.priority == 'medium' ? 'yellow' : 'gray' %>-800">
              <%= ticket.priority.humanize %>
            </span>
            <span class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
              <%= ticket.status.humanize %>
            </span>
          </div>
          <div class="mt-2 sm:flex sm:justify-between">
            <div class="sm:flex">
              <p class="flex items-center text-sm text-gray-500">
                <%= ticket.customer.name %>
              </p>
              <p class="mt-2 flex items-center text-sm text-gray-500 sm:mt-0 sm:ml-6">
                <%= ticket.category.humanize %>
              </p>
            </div>
            <div class="mt-2 flex items-center text-sm text-gray-500 sm:mt-0">
              <% if ticket.due_at.present? %>
                <p class="<%= ticket.overdue? ? 'text-red-600 font-semibold' : ticket.due_soon? ? 'text-orange-600' : '' %>">
                  Due: <%= ticket.due_at.strftime("%b %d, %Y") %>
                </p>
              <% end %>
            </div>
            <div class="mt-2 sm:mt-0">
              <% if current_admin.super_admin? %>
                <p class="text-sm text-gray-500">Assignee: <%= ticket.assigned_to&.name || 'Unassigned' %></p>
              <% end %>
            </div>
          </div>
          <% if ticket.followups.upcoming.any? %>
            <div class="mt-2 text-xs text-gray-500">
              <span class="font-medium"><%= ticket.followups.upcoming.count %> upcoming followup(s)</span>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>

  <% if policy(ticket).change_assignee? || policy(ticket).update? %>
    <div class="px-4 py-2 bg-gray-50 flex space-x-2 border-t">
      <% if policy(ticket).change_assignee? %>
        <button type="button" onclick="event.stopPropagation(); openAssignmentModal('<%= "assignment_modal_#{ticket.class.name.demodulize.underscore}_#{ticket.id}" %>')" class="bg-indigo-600 text-white px-3 py-1 rounded text-sm">Assign</button>
        <%= render 'forefront/assignments/form', assignable: ticket, admins: @admins %>
      <% end %>
      <% if policy(ticket).update? %>
        <button type="button" onclick="event.stopPropagation(); openFollowupModal('<%= "followup_modal_#{ticket.class.name.demodulize.underscore}_#{ticket.id}" %>')" class="bg-green-600 text-white px-3 py-1 rounded text-sm">+ Followup</button>
        <%= render 'forefront/followups/form', followupable: ticket %>
      <% end %>
    </div>
  <% end %>

</li>